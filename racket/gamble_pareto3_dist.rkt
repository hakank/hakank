#| 

  Pareto type III distribution in Racket/Gamble 

  From Mathematica ParetoDistribution

  ParetoDistribution[k,1,gamma,mu]

  i.e. pareto_dist4(k,1,gamma,mu)



  This program was created by Hakan Kjellerstrand, hakank@gmail.com
  See also my Racket page: http://www.hakank.org/racket/

|#

#lang gamble

; (require gamble/viz)
(require racket)
(require "gamble_utils.rkt")
(require "gamble_distributions.rkt")

#|

  variable : d
  4.037469403703529: 1.0000000000019164e-5
  2.8789990071647873: 1.0000000000019164e-5
  9.624589269204671: 1.0000000000019164e-5
  2.5212834981145793: 1.0000000000019164e-5
  3.5147844751786996: 1.0000000000019164e-5
  ...
  2.5433163679454442: 1.0000000000019164e-5
  5.017233307370223: 1.0000000000019164e-5
  2.878124116842839: 1.0000000000019164e-5
  2.8935488747781912: 1.0000000000019164e-5
  3.884959744911844: 1.0000000000019164e-5
  mean: 3.3353206853322455
  HPD interval (0.84): 1.6387636600129816..4.466243135525829
  HPD interval (0.9): 1.5235998608951222..5.022723368492755
  HPD interval (0.99): 1.1811884763208926..8.979336548488584
  HPD interval (0.99999): 1.032558216933082..57.79868963993348
  Percentiles:
  (0.01 1.5053529146780749)
  (0.025 1.6679829245760724)
  (0.1 2.0361995671365642)
  (0.05 1.823699185768978)
  (0.25 2.4402986420754145)
  (0.5 3.001987721350424)
  (0.75 3.7762407592503626)
  (0.84 4.29751107352347)
  (0.9 4.867765614956472)
  (0.95 5.826401278468024)
  (0.975 7.014331219665171)
  (0.99 8.909648497091139)
  (0.999 16.4719391587291)
  Histogram:
1.033 :     1 # (1e-5  / 0    )
1.636 :  2133 ####### (0.021 / 1e-5 )
2.24  : 14766 ############################################# (0.147 / 0.021)
2.844 : 26468 ################################################################################ (0.264 / 0.169)
3.448 : 22925 ###################################################################### (0.229 / 0.433)
4.052 : 14045 ########################################### (0.140 / 0.662)
4.656 :  7835 ######################## (0.078 / 0.803)
5.26  :  4393 ############## (0.043 / 0.881)
5.864 :  2528 ######## (0.025 / 0.925)
6.468 :  1508 ##### (0.015 / 0.950)
7.072 :   975 ### (0.009 / 0.966)
7.675 :   641 ## (0.006 / 0.975)
8.279 :   441 ## (0.004 / 0.982)
8.883 :   331 ## (0.003 / 0.986)
9.487 :   226 # (0.002 / 0.989)
10.091:   172 # (0.001 / 0.992)
10.695:   131 # (0.001 / 0.993)
11.299:    83 # (0.000 / 0.995)
11.903:    56 # (0.000 / 0.996)
12.507:    73 # (0.000 / 0.996)
13.11 :    41 # (0.000 / 0.997)
13.714:    28 # (0.000 / 0.997)
14.318:    25 # (0.000 / 0.998)
14.922:    32 # (0.000 / 0.998)
15.526:    19 # (0.000 / 0.998)
16.13 :    17 # (0.000 / 0.998)
16.734:    13 # (0.000 / 0.998)
17.338:    14 # (0.000 / 0.999)
17.942:     7 # (7e-5  / 0.999)
18.546:     8 # (8e-5  / 0.999)
19.149:     5 # (5e-5  / 0.999)
19.753:     3 # (3e-5  / 0.999)
20.357:     2 # (2e-5  / 0.999)
20.961:     7 # (7e-5  / 0.999)
21.565:     3 # (3e-5  / 0.999)
22.169:     3 # (3e-5  / 0.999)
22.773:     3 # (3e-5  / 0.999)
23.377:     2 # (2e-5  / 0.999)
23.981:     3 # (3e-5  / 0.999)
24.584:     2 # (2e-5  / 0.999)
25.188:     3 # (3e-5  / 0.999)
25.792:     2 # (2e-5  / 0.999)
26.396:     2 # (2e-5  / 0.999)
27    :     2 # (2e-5  / 0.999)
27.604:     2 # (2e-5  / 0.999)
28.208:     0  (0     / 0.999)
28.812:     0  (0     / 0.999)
29.416:     1 # (1e-5  / 0.999)
30.02 :     0  (0     / 0.999)
30.623:     0  (0     / 0.999)
31.227:     1 # (1e-5  / 0.999)
31.831:     1 # (1e-5  / 0.999)
32.435:     0  (0     / 0.999)
33.039:     0  (0     / 0.999)
33.643:     0  (0     / 0.999)
34.247:     1 # (1e-5  / 0.999)
34.851:     2 # (2e-5  / 0.999)
35.455:     1 # (1e-5  / 0.999)
36.058:     1 # (1e-5  / 0.999)
36.662:     0  (0     / 0.999)
37.266:     1 # (1e-5  / 0.999)
37.87 :     1 # (1e-5  / 0.999)
38.474:     0  (0     / 0.999)
39.078:     0  (0     / 0.999)
39.682:     0  (0     / 0.999)
40.286:     0  (0     / 0.999)
40.89 :     0  (0     / 0.999)
41.494:     0  (0     / 0.999)
42.097:     1 # (1e-5  / 0.999)
42.701:     2 # (2e-5  / 0.999)
43.305:     2 # (2e-5  / 0.999)
43.909:     1 # (1e-5  / 0.999)
44.513:     0  (0     / 0.999)
45.117:     0  (0     / 0.999)
45.721:     0  (0     / 0.999)
46.325:     0  (0     / 0.999)
46.929:     0  (0     / 0.999)
47.532:     0  (0     / 0.999)
48.136:     0  (0     / 0.999)
48.74 :     1 # (1e-5  / 0.999)
49.344:     1 # (1e-5  / 0.999)
49.948:     0  (0     / 0.999)
50.552:     1 # (1e-5  / 0.999)
51.156:     0  (0     / 0.999)
51.76 :     0  (0     / 0.999)
52.364:     0  (0     / 0.999)
52.968:     0  (0     / 0.999)
53.571:     0  (0     / 0.999)
54.175:     0  (0     / 0.999)
54.779:     0  (0     / 0.999)
55.383:     0  (0     / 0.999)
55.987:     0  (0     / 0.999)
56.591:     0  (0     / 0.999)
57.195:     0  (0     / 0.999)

  variable : p
  #f: 0.9892200000038438
  #t: 0.010780000000020648
  mean: 0.010780000000020648
Histogram:
#f: 99013 ################################################################################ (0.990 / 0    )
#t:   987 # (0.009 / 0.990)

|#
(define (model)
  (; enumerate
   ; rejection-sampler
   importance-sampler
   ; mh-sampler

   (define k 2)
   (define gamma 0.3)
   (define mu 1)

   (define d (pareto3_dist k gamma mu))
   (define p (>= d (pareto3_quantile k gamma mu 0.99)))
   
   (list d
         p)

   )
)

(show-marginals (model)
                (list  "d"
                       "p"
                       )
                #:num-samples 100000
                #:truncate-output 5
                ; #:skip-marginals? #t
                ; #:show-stats? #t
                ; #:credible-interval 0.84
                #:hpd-interval (list 0.84 0.9 0.99 0.99999)
                #:show-histogram? #t
                #:show-percentiles? #t
                ; #:burn 0
                ; #:thin 0
                )


