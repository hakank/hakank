#| 

  BUGS book, 2.6.1 in Racket Gamble.

  Example 2.6.1 Heart transplant cost-effectiveness: risks assumed known

var : sN
1.1322718656403001: 0.0009999999999999994
1.085303237757104: 0.0009999999999999994
...
1.0428579690006379: 0.0009999999999999994
0.20255295408776985: 0.0009999999999999994
mean: 0.513604681870242
Min: 0.0001635480213632769 Mean: 0.4721870157520654 Max: 2.7741526938460197 Variance: 0.20340950856249718 Stddev: 0.45100943289746964
Credible interval (0.84): 0.0001635480213632769..0.8553673094218094

var : oT
1: 0.8020000000000006
0: 0.19800000000000015
mean: 0.8020000000000006
Min: 0 Mean: 0.797 Max: 1 Variance: 0.161791 Stddev: 0.4022325198190718
Credible interval (0.84): 0..1

var : sP
0.09646936573622487: 0.0009999999999999994
0.4353913119935233: 0.0009999999999999994
...
0.18359986464162148: 0.0009999999999999994
0.049926364726843815: 0.0009999999999999994
mean: 0.19368799598750325
Min: 6.104298375663182e-5 Mean: 0.19112646475955045 Max: 1.151562211902446 Variance: 0.035679381139305216 Stddev: 0.18888986510478856
Credible interval (0.84): 6.104298375663182e-5..0.34851816317386736

var : sT
0: 0.19800000000000015
0.09646936573622487: 0.0009999999999999994
...
0.18359986464162148: 0.0009999999999999994
0.049926364726843815: 0.0009999999999999994
mean: 0.16046164660048307
Min: 0.0 Mean: 0.15569228070262547 Max: 1.151562211902446 Variance: 0.035436112003132875 Stddev: 0.18824481932614473
Credible interval (0.84): 0..0.3147344389598026

var : Ic
20000: 0.19800000000000015
20688.764562036264: 0.0009999999999999994
...
20859.47576149682: 0.0009999999999999994
20056.842811480292: 0.0009999999999999994
mean: 20481.38493980143
Min: 20000.0 Mean: 20467.076842107857 Max: 23454.686635707338 Variance: 318925.0080281968 Stddev: 564.734457978435
Credible interval (0.84): 20000..20944.203316879408

var : Is
-0.29268629789674505: 0.0009999999999999994
-0.013994174788792613: 0.0009999999999999994
...
-0.9638307581445775: 0.0009999999999999994
-0.045733902395558024: 0.0009999999999999994
mean: -0.3531430352697583
Min: -2.7720883886115883 Mean: -0.3164947350494393 Max: 0.8959192843706912 Variance: 0.2276177342985606 Stddev: 0.4770930038247895
Credible interval (0.84): -0.8166016992501387..0.28498744218807043

var : r
174430.892132615: 0.0009999999999999994
-45194.194652282946: 0.0009999999999999994
...
-11295.935306223519: 0.0009999999999999994
-46220.47112940498: 0.0009999999999999994
mean: -125215.43031823421
Min: -1101610641.3507323 Mean: -1238850.494404302 Max: 60215011.24285489 Variance: 1236758718012869.5 Stddev: 35167580.496998504
Credible interval (0.84): -341396.7037543335..275529.22735069087

  This program was created by Hakan Kjellerstrand, hakank@gmail.com
  See also my Racket page: http://www.hakank.org/racket/

|#

#lang gamble

(require racket)
(require "gamble_utils.rkt")

(define (bugs-book-2-6-1)
  (; rejection-sampler
   importance-sampler
   ; mh-sampler

   (define sN (exponential 0.5))      ;; life without transplant (mean 2)
   (define oT (bernoulli 0.8))        ;; survive operation (prob 0.8)
   (define sP (exponential 0.2))      ;; life if survive transplant (mean 5)
   (define sT (* oT sP))              ;; total life time if choose transplant
   (define Ic (+ 20000 (* 3000 sT)))  ;; total additional cost of transplant
   (define Is (- sT sN))              ;; total additional survival
   (define  r (/ Ic Is))              ;; individual cost per additional year

   (list sN oT sP sT Ic Is r)
    )
  )

(show-marginals (bugs-book-2-6-1)
                (list "sN" "oT" "sP" "sT" "Ic" "Is" "r")
                #:truncate-output 2
                #:show-stats? #t
                #:credible-interval 0.84
                )

