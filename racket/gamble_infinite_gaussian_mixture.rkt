#| 

  Infinite gaussian mixture in Racket Gamble.

   From Yi Wu, Lei Li, Stuart Russell, Rastislav Bodik
  "Swift: Compiled Inference for Probabilistic Programming Languages"
  Page 3

var : cluster
3: 0.25992280980240734
2: 0.2412581778570123
4: 0.19989255061091682
5: 0.10848001805692316
1: 0.09056107373521753
6: 0.05790938917494925
...
8: 0.01157629892988366
9: 0.0045169341211507225
10: 0.0009846590839897543
11: 0.0005080879639028129
12: 0.000316456018524312
16: 1.1640721087334502e-9
mean: 3.363283138822755

var : x 0
2.7684724202481372: 0.00018945831325359306
-0.2258231475817081: 0.00018945831325359306
-1.27965805601668: 0.00018945831325359306
-0.20066675878445916: 0.00018945831325359306
-0.860174001315358: 0.00018945831325359306
0.5277615839191041: 0.00018945831325359306
...
6.550315152694558: 5.3398103289635644e-18
9.848685683495546: 5.3398103289635644e-18
10.875255240515052: 5.3398103289635644e-18
7.910635251286438: 1.200748860296612e-21
7.911795363997072: 1.200748860296612e-21
11.23682311893952: 1.200748860296612e-21
mean: 0.4637008169210528

var : x 1
0.9157314398432582: 0.00018945831325359306
2.7636819099737426: 0.00018945831325359306
2.352046787374535: 0.00018945831325359306
2.251787331169594: 0.00018945831325359306
3.512343960453358: 0.00018945831325359306
-0.4987508646733286: 0.00018945831325359306
...
1.5663489489417262: 5.3398103289635644e-18
1.5870941942909844: 5.3398103289635644e-18
7.393686075257671: 5.3398103289635644e-18
5.2998437126620574: 1.200748860296612e-21
5.565972888085887: 1.200748860296612e-21
1.905045582457609: 1.200748860296612e-21
mean: 1.1945191477724169

var : x 2
1.3158302061317162: 0.00018945831325359306
0.9979478864097363: 0.00018945831325359306
-0.7279630056502537: 0.00018945831325359306
0.6294958132820447: 0.00018945831325359306
1.3644841882735954: 0.00018945831325359306
0.0511007168741322: 0.00018945831325359306
...
6.673656865154255: 5.3398103289635644e-18
2.3431683338220353: 5.3398103289635644e-18
6.747792382274424: 5.3398103289635644e-18
5.766701776100806: 1.200748860296612e-21
2.2113852226615736: 1.200748860296612e-21
3.1430126801712674: 1.200748860296612e-21
mean: 1.224471959482284




  This is a port om my WebPPL model infinite_gaussian_mixture.wppl

  This program was created by Hakan Kjellerstrand, hakank@gmail.com
  See also my Racket page: http://www.hakank.org/racket/

|#

#lang gamble

; (require gamble/viz)
(require racket)
(require "gamble_utils.rkt")

(define (hypothesis-testing)
  
  (; enumerate
   ; rejection-sampler
   importance-sampler
   ; mh-sampler
   
   (define cluster (add1 (poisson 3))) ;; Number of clusters
    
   (define (mu c) 
     (normal 0 10)); ;; Cluster mean
   
   (define (z d) (random-integer cluster))

   ;; data
   (defmem (x d)
     (normal-dist (z d) 1))

   (observe-sample (x 0) 0.1); ;; omit other data points
    ;; (observe (x 1) 0.1); ;; omit other data points
    ;; (observe (x 2) 0.1); ;; omit other data points        

   (list cluster
         (sample (x 0))
         (sample (x 1))
         (sample (x 2))
         
    )
    
   )
  )

(show-marginals (hypothesis-testing)
                (list "cluster"
                      "x 0"
                      "x 1"
                      "x 2"
                      )
                #:num-samples 10000
                #:truncate-output 6
                ; #:skip-marginals? #t
                ; #:show-stats? #t
                ; #:credible-interval 0.84
                ; #:credible-interval2 0.84                
                ; #:show-histogram? #t
                ; #:show-percentiles? #t
                )

