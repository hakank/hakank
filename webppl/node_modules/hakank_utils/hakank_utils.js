var fs = require('fs');


/*
   Histogram function

   This is aliased in hakank_utils.wppl as
     histogram1(values, num_bins)
   
*/
var histogram1 = function(values,num_bins) {
    if (typeof values[0] === "number") {
        // numeric values
        var min = _.min(values)
        var max = _.max(values)
        // console.log("min:",min,"max:",max)
        var width = (max-min)/num_bins
        var bins = new Array(num_bins+1).fill(0);
        for(v of values) {
            var t = Math.ceil((v-min)/width)
            bins[t] += 1
        }
    } else {
        // non-numeric values
        var bins = new Object()
        for(v of values) {
            if (!bins[v]) {
                bins[v] = 1
            } else {
                bins[v] += 1
            }
        }
    }
    return {
        bins:bins,
    }
    
}

/*
    Pluck values (key) from an array of dicts.

   From https://stackoverflow.com/questions/25726066/equivalent-of-underscore-pluck-in-pure-javascript
*/
var pluck = function(arr,key){
    var newArr = [];
    for (var i = 0, x = arr.length; i < x; i++){
        if (arr[i].hasOwnProperty(key)){
            newArr.push(arr[i][key])
        }
    }
    return newArr;
}

// Test function
var hello = function(name) {
    return "hello, " + name
}

module.exports = {
    histogram1:histogram1,
    pluck:pluck,

    hello: hello,
};
